# This is an example ThreatIngestor config file with some preconfigured RSS
# sources, feeding extracted artifacts into a CSV file.

general:
    # Run forever, check feeds once an hour.
    daemon: True
    sleep: 10
    onion_validation: ([a-z2-7]{16,56}\.onion)
    blacklist: blacklist,keywords,go,here
    interestingKeywords: Interesting,Keywords,Go,Here
    save-thread: no         # Use a separate thread to save onions
    TorController:
        port: 9051
        password: YOUR-TOR-CONTROLLER-PASSWORD

monitor:
    filename: monitoring.txt

sources:
    # A few threat intel blogs to get you started!
    - name: simple-text-file
      module: simplefile
      filename: onion_master_list.txt

    #  - name: source-gist
    #    module: gist
    #    url: https://gist.github.com/search?l=Text&q=.onion

    #  - name: source-reddit
    #    module: reddit
    #    url: https://api.pushshift.io/reddit/search/comment/?subreddit=onions&limit=1000000
    #    feed_type: messy
    #
    #  - name: pastebin
    #    module: pastebin-account
    #    url: https://gist.github.com/search?l=Text&q=.onion
    #    feed_type: messy
    #
    #  - name: hunchly-report
    #    module: gmail-hunchly
    #    url: https://gist.github.com/search?l=Text&q=.onion
    #    feed_type: messy
    #
    #  - name: onionland-search
    #    module: collect-onions
    #    url: http://3bbaaaccczcbdddz.onion/discover
    #    feed_type: messy
    #
    #  - name: torch
    #    module: collect-onions
    #    url: http://xmh57jrzrnw6insl.onion
    #    feed_type: messy


operators:
   - name: simple-html
     module: html
     timeout: 300
     retries: 2
     interestingKeywords: t.me,feed,rss,xml,atom,dataleak,breach,blog,ransomware,source code,data breach
     socks5:
         http: 'socks5h://127.0.0.1:9050'
         https: 'socks5h://127.0.0.1:9050'

   - name: onionscan-go
     module: onionscan
     binpath: /home/tony/go/src/github.com/s-rah/onionscan/test123
                  #        - name: simple-screenshot
                  #          module: screenshot
                  #          screenshots_path: null
                  #
                  #        - name: onionscan-go
                  #          module: onionscan
                  #          binpath: /home/tony/go/bin/onionscan
                  #

    #  - name: yara-rule
    #    module: yara
    #    filename: categories.yar
    #    base_score: 50
    #
    #  - name: regex-match
    #    module: regex
    #    keywords: test,test2
    #    base_score: 20

database_Engines:
    # Simple telegram notifier
  - name: telegram-notifer
    module: telegram
    chat_id: YOUR-TELEGRAM-CHAT
    token: YOUR-TELEGRAM-TOKEN

  - name: elasticsearch
    module: elasticsearch
    index: YOUR-ELASTICSEARCH-INDEX_NAME
    port : 9200
    host : 127.0.0.1

    #  - name: email
    #    module: send_email
    #    alert: no             # Enable/disable email alerts
    #    from: alert@example.com
    #    to: alert@example.com
    #    server: 127.0.0.1     # Address of the server (hostname or IP)
    #    port: 25              # Outgoing SMTP port: 25, 587, ...
    #    tls: no               # Enable/disable tls support
    #    username: ''          # (optional) Username for authentication. Leave blank for no authentication.
    #    password: ''          # (optional) Password for authentication. Leave blank for no authentication.
    #    subject: '[onioningestor] - {subject}'
    #    size-limit: 1048576   # Size limit for pastie, above it's sent as attachement
